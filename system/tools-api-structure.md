# Tools接口拆分结构说明

## 拆分概述

将tools相关接口从 `system/get.js` 拆分到独立的 `system/tools.js` 文件中，实现模块化管理。

## 文件结构

### 拆分前
```
Api/
├── system/
│   └── get.js          # 包含所有前台接口（轮播图、文章、工具）
└── router.js           # 路由配置
```

### 拆分后
```
Api/
├── system/
│   ├── get.js          # 只包含轮播图、文章等通用接口
│   └── tools.js        # 专门处理工具相关接口
└── router.js           # 更新了路由配置
```

## 接口清单

### `system/tools.js` - 工具接口模块

| 接口路径 | 方法 | 描述 | 状态 |
|---------|------|------|------|
| `/api/tools` | GET | 获取所有启用的工具列表 | ✅ |
| `/api/tools/:id` | GET | 根据ID获取单个工具详情 | ✅ |
| `/api/tools/category/:category` | GET | 根据分类获取工具列表 | ✅ |

### 接口详情

#### 1. 获取工具列表
- **路径**: `GET /api/tools`
- **描述**: 获取所有状态为启用(status=1)的工具
- **响应**: 包含count和data数组

#### 2. 获取工具详情
- **路径**: `GET /api/tools/:id`
- **描述**: 根据工具ID获取单个工具的详细信息
- **参数**: id - 工具ID
- **响应**: 单个工具对象

#### 3. 按分类获取工具
- **路径**: `GET /api/tools/category/:category`
- **描述**: 根据iconClass分类获取工具列表
- **参数**: category - 分类名称（如：camera, music, wechat等）
- **响应**: 包含count和该分类下的工具数组

## 路由配置

### `router.js` 更新内容

```javascript
//前台获取信息类，不使用token，包含轮播图、文章
app.use('/api', require('./system/get.js'))
//工具相关接口，不使用token
app.use('/api', require('./system/tools.js'))  // 新增
```

## 优势

### 1. 模块化管理
- 工具相关接口集中管理
- 代码职责更清晰
- 便于维护和扩展

### 2. 可扩展性
- 可独立为tools模块添加新功能
- 不影响其他模块的接口
- 支持工具分类查询

### 3. 代码复用
- 统一的错误处理
- 统一的数据库连接
- 统一的响应格式

## 测试验证

### 基本功能测试
```bash
# 获取工具列表
curl http://127.0.0.1:8088/api/tools

# 获取单个工具
curl http://127.0.0.1:8088/api/tools/1

# 按分类查询
curl http://127.0.0.1:8088/api/tools/category/camera
```

### 预期响应格式

#### 工具列表响应
```json
{
    "code": 200,
    "msg": "获取成功",
    "count": 4,
    "data": [...]
}
```

#### 单个工具响应
```json
{
    "code": 200,
    "msg": "获取成功",
    "data": {
        "id": 1,
        "title": "针孔摄像头探测",
        ...
    }
}
```

#### 错误响应
```json
{
    "code": 404,
    "msg": "工具不存在"
}
```

## 数据库表

### tools表结构保持不变
- 所有接口都基于相同的tools表
- 通过status字段控制显示状态
- 支持按iconClass进行分类查询

## 部署说明

### PM2重启
拆分后需要重启服务：
```bash
pm2 restart api-server
```

### 验证步骤
1. 检查PM2服务状态
2. 测试原有接口功能
3. 测试新增接口功能
4. 验证前端调用正常

## 注意事项

1. **向后兼容**: 原有的 `/api/tools` 接口保持不变
2. **新功能**: 增加了单个工具查询和分类查询
3. **性能**: 使用参数化查询防止SQL注入
4. **错误处理**: 统一的错误响应格式

## 未来扩展

可以在 `tools.js` 中继续添加：
- 工具搜索接口
- 工具推荐接口
- 工具统计接口
- 工具收藏接口

---

**创建时间**: 2025-06-09  
**作者**: lishengmin  
**版本**: 1.0.0 